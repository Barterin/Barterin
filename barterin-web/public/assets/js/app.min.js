const loadFile=function(e,t=!1){return new Promise((n,a)=>{const r=e.split(".").pop();if("js"==r){const a=document.createElement("script");return a.setAttribute("defer",""),0==t&&a.setAttribute("temp",""),a.src=`${e}${0==t?`?${+new Date}`:""}`,a.addEventListener("load",function(){n(!0)}),document.head.appendChild(a)}if("css"==r){const a=document.createElement("link");a.rel="stylesheet",0==t&&a.setAttribute("temp",""),a.type="text/css",a.href=e,a.addEventListener("load",function(){return n(!0)}),document.head.appendChild(a)}})};let sc,nanobar,__access_token;const loadFiles=function(e,t=!1){return new Promise((n,a)=>{let r=e.length,s=0;e.forEach(async function(e){await loadFile(e,t),s++,r==s&&n(!0)})})},redirect=function(e){window.location.replace(e)};let currentPage=location.href;const socketUrl=document.querySelector('meta[name="socket-url"]').getAttribute("content"),apiUrl=document.querySelector('meta[name="api-url"]').getAttribute("content"),baseUrl=document.querySelector('meta[name="base-url"]').getAttribute("content"),environmentStatus=document.querySelector('meta[name="environment"]').getAttribute("content");__access_token=document.querySelector('meta[name="access-token"]').getAttribute("content");const detectLoadJs=function(e=document){const t=document.querySelectorAll("script[temp]");t.forEach((e,t)=>{e.remove()});const n=e.evaluate("//*[starts-with(name(),'loadjs-')]",e,null,XPathResult.ANY_TYPE,null);let a=[],r=null;for(;r=n.iterateNext();){a.push(r)}a.forEach((e,t)=>{loadFile(`/assets/js/page/${e.localName.split("-")[1]}${"production"==environmentStatus?".min":""}.js`),e.remove()})},detectLoadCSS=function(e=document){const t=document.querySelectorAll("link[temp]");t.forEach((e,t)=>{e.remove()});const n=e.evaluate("//*[starts-with(name(),'loadcss-')]",e,null,XPathResult.ANY_TYPE,null);let a=[],r=null;for(;r=n.iterateNext();){a.push(r)}a.forEach((e,t)=>{loadFile(`/assets/css/page/${e.localName.split("-")[1]}${"production"==environmentStatus?".min":""}.css`),e.remove()})},loadPage=function(e,t=!1){if(e==currentPage&&0==t){return}if("#"==e){return}nanobar.go(80),currentPage=e;$(`a.menu-item[href='${e.trim()}']`);0==t&&window.history.pushState("",window.title,e),$.ajax({url:e,headers:{"Load-From-Ajax":!0},success:function(e){$("main").html($(e).filter("main").html()),$(".webTitle").html($(e).filter("title").text())}}).fail(function(e){$("#contentId").html(`<div class="container">${e.statusText}</div>`),nanobar.go(100)}).done(function(){detectLoadJs(),detectLoadCSS(),initahref(),nanobar.go(100)})},disableButton=function(){$(":submit").append(' <span class="spinner-border spinner-border-sm" role="status" aria-hidden="true"></span>'),$(":submit").attr("disabled",!0)},enableButton=function(){$(":submit").find("span").remove(),$(":submit").removeAttr("disabled")},msgSweetError=function(e,t={title:"Error",timer:3e3}){return Swal.fire({icon:"error",html:e,title:t.title,timer:t.timer,timerProgressBar:!0})},msgSweetSuccess=function(e,t={title:"Sukses",timer:3e3}){return Swal.fire({icon:"success",html:e,title:t.title,timer:t.timer,timerProgressBar:!0})},msgSweetWarning=function(e,t={title:"Peringatan",timer:3e3}){return Swal.fire({icon:"warning",html:e,title:t.title,timer:t.timer,timerProgressBar:!0})},msgSweetInfo=function(e,t={title:"Informasi",timer:3e3}){return Swal.fire({icon:"info",html:e,title:t.title,timer:t.timer,timerProgressBar:!0})},confirmSweet=function(e,t={title:"Konfirmasi",confirmBtn:"Ya",cancelBtn:"Tidak"}){return Swal.fire({icon:"warning",title:t.title,html:e,showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:t.confirmBtn,cancelButtonText:t.cancelBtn})},isConfirmed=function(e){return 1==e.isConfirmed},validate=function(e){$("input[class*='validate']").removeClass("is-invalid validate"),Object.keys(e).forEach(t=>{$(`input[name="${t}"]`).addClass("is-invalid validate"),$(`[id='validate_${t}']`).addClass("invalid-feedback"),$(`[id='validate_${t}']`).html(e[t][0])}),$(`[name="${Object.keys(e)[0]}"].is-invalid`).select()},initahref=function(){$("a.internal").unbind().click(function(e){e.preventDefault();let t=$(this).attr("href");loadPage(t)})};loadFiles([`${baseUrl}/assets/bootstrap/css/bootstrap.css`,`${baseUrl}/assets/bootstrap/js/bootstrap.bundle.min.js`,`${baseUrl}/assets/plugins/jquery/jquery.min.js`,`${baseUrl}/assets/plugins/sweetalert2/sweetalert2.css`,`${baseUrl}/assets/css/style.css`,`${baseUrl}/assets/plugins/sweetalert2/sweetalert2.min.js`,`${baseUrl}/assets/plugins/nanobar/nanobar.min.js`,`${socketUrl}/socket.io/socket.io.js`],!0).then(function(){nanobar=new Nanobar({classname:"loadingGan"}),sc=io(socketUrl),detectLoadJs(),initahref(),$(window).on("popstate",function(e){currentPage.replace(/#/g,"")!=location.href.replace(/#/g,"")&&(currentPage=location.href,loadPage(currentPage,!0))}),$("#btnLogout").click(e=>{e.preventDefault(),$.ajax({url:`${apiUrl}/auth/logout`,method:"post",headers:{Authorization:`Bearer ${__access_token}`},dataType:"JSON",success:function(e){200==e.statusCode&&location.reload()},error:function(e){const t=e.responseJSON;500==t.statusCode&&msgSweetError(t.message,1),401==t.statusCode&&msgSweetWarning(t.message)}})})}),detectLoadCSS();